# Application
NODE_ENV=development
PORT=3000

# Database (PostgreSQL)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/app_db

# JWT (access token only; refresh tokens are random values stored in DB)
JWT_ACCESS_SECRET=your-access-secret-min-32-chars-long-please
JWT_ACCESS_EXPIRES_IN=15m
# Issuer (iss) and optional audience (aud) for token validation (défaut: JWT_ISSUER=express-stripe-auth)
# JWT_ISSUER=express-stripe-auth
# JWT_AUDIENCE=api

# Refresh tokens (DB, hashés) + cookie
REFRESH_TOKEN_TTL_DAYS=30
# COOKIE_SECURE=true en production (défaut: true si NODE_ENV=production ou COOKIE_SAMESITE=none)
# COOKIE_SECURE=false
# COOKIE_SAMESITE=lax (ou none pour front sur autre domaine; none exige Secure)
# COOKIE_DOMAIN= (optionnel, ex: .example.com pour sous-domaines)
# ENABLE_DEMO=1 to serve /demo in production (default: off in prod)
# LOG_STACK_IN_PROD=false (prod: do not log stack unless set to true for debugging)

# PaymentEvent retention (RGPD)
# PAYMENT_EVENT_RETENTION_MODE=retain (or erase)
# PAYMENT_EVENT_RETENTION_DAYS=365

# Proxy (obligatoire en prod si app derrière Nginx/Render/Fly : IP client et cookies)
# TRUST_PROXY=1

# Stripe (remplacer par vos clés réelles)
STRIPE_SECRET_KEY=sk_test_placeholder
STRIPE_API_VERSION=2025-02-24.acacia
# Pour la demo locale : http://localhost:3000/demo
STRIPE_SUCCESS_URL=http://localhost:3000/demo
STRIPE_CANCEL_URL=http://localhost:3000/demo
STRIPE_WEBHOOK_SECRET=whsec_placeholder
# Aligner STRIPE_API_VERSION avec la version du Stripe Dashboard si besoin
WEBHOOK_BODY_LIMIT=1mb
STRIPE_PUBLISHABLE_KEY=pk_test_placeholder

# CORS (comma-separated origins; Vite dev often uses 5173 or 5174)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:5174

# Rate limits (requests per window)
RATE_LIMIT_AUTH_WINDOW_MS=900000
RATE_LIMIT_AUTH_MAX=10
RATE_LIMIT_REFRESH_WINDOW_MS=900000
RATE_LIMIT_REFRESH_MAX=30
RATE_LIMIT_WEBHOOK_WINDOW_MS=60000
RATE_LIMIT_WEBHOOK_MAX=100
RATE_LIMIT_CHECKOUT_WINDOW_MS=60000
RATE_LIMIT_CHECKOUT_MAX=30